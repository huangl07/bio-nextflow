10月-12 16:27:15.141 [main] DEBUG nextflow.cli.Launcher - $> nextflow run Ampliseq.nf --fqlist fastq1.list --out demo -resume --meta meta.list
10月-12 16:27:15.315 [main] INFO  nextflow.cli.CmdRun - N E X T F L O W  ~  version 21.04.3
10月-12 16:27:15.356 [main] INFO  nextflow.cli.CmdRun - Launching `Ampliseq.nf` [tender_monod] - revision: 38090b0d81
10月-12 16:27:15.476 [main] DEBUG nextflow.plugin.PluginsFacade - Setting up plugin manager > mode=prod; plugins-dir=/mnt/ilustre/users/dna/.nextflow/plugins
10月-12 16:27:15.478 [main] DEBUG nextflow.plugin.PluginsFacade - Plugins default=[]
10月-12 16:27:15.481 [main] DEBUG nextflow.plugin.PluginsFacade - Plugins local root: .nextflow/plr/empty
10月-12 16:27:15.492 [main] INFO  org.pf4j.DefaultPluginStatusProvider - Enabled plugins: []
10月-12 16:27:15.493 [main] INFO  org.pf4j.DefaultPluginStatusProvider - Disabled plugins: []
10月-12 16:27:15.498 [main] INFO  org.pf4j.DefaultPluginManager - PF4J version 3.4.1 in 'deployment' mode
10月-12 16:27:15.512 [main] INFO  org.pf4j.AbstractPluginManager - No plugins
10月-12 16:27:15.588 [main] DEBUG nextflow.Session - Session uuid: 89ee96c2-4d8d-475a-b515-4b68408c2150
10月-12 16:27:15.588 [main] DEBUG nextflow.Session - Run name: tender_monod
10月-12 16:27:15.592 [main] DEBUG nextflow.Session - Executor pool size: 64
10月-12 16:27:15.654 [main] DEBUG nextflow.cli.CmdRun - 
  Version: 21.04.3 build 5560
  Created: 21-07-2021 15:09 UTC (23:09 CDT)
  System: Linux 4.18.0-240.22.1.el8_3.x86_64
  Runtime: Groovy 3.0.7 on Java HotSpot(TM) 64-Bit Server VM 11.0.11+9-LTS-194
  Encoding: UTF-8 (UTF-8)
  Process: 804119@compute-5-95 [10.2.4.236]
  CPUs: 64 - Mem: 125.2 GB (9.5 GB) - Swap: 4 GB (1.5 GB)
10月-12 16:27:15.723 [main] DEBUG nextflow.Session - Work-dir: /mnt/ilustre/users/dna/Pipeline/NextFlow/bio-nextflow/Ampliseq/work [lustre]
10月-12 16:27:15.752 [main] DEBUG nextflow.executor.ExecutorFactory - Extension executors providers=[]
10月-12 16:27:15.769 [main] DEBUG nextflow.Session - Observer factory: DefaultObserverFactory
10月-12 16:27:15.987 [main] DEBUG nextflow.Session - Session start invoked
10月-12 16:27:17.549 [main] DEBUG nextflow.script.ScriptRunner - > Launching execution
10月-12 16:27:17.560 [main] DEBUG nextflow.Session - Workflow process names [dsl1]: Hierarchical, PCOA, classify, importfq, Dist, adonis, Alpha, DeNoise, Tree, Abundance, Rarecurve
10月-12 16:27:17.885 [main] DEBUG nextflow.executor.ExecutorFactory - << taskConfig executor: slurm
10月-12 16:27:17.886 [main] DEBUG nextflow.executor.ExecutorFactory - >> processorType: 'slurm'
10月-12 16:27:17.913 [main] DEBUG nextflow.executor.Executor - [warm up] executor > slurm
10月-12 16:27:17.927 [main] DEBUG n.processor.TaskPollingMonitor - Creating task monitor for executor 'slurm' > capacity: 100; pollInterval: 5s; dumpInterval: 5m 
10月-12 16:27:17.938 [main] DEBUG n.executor.AbstractGridExecutor - Creating executor 'slurm' > queue-stat-interval: 1m
10月-12 16:27:18.464 [main] DEBUG nextflow.executor.ExecutorFactory - << taskConfig executor: slurm
10月-12 16:27:18.465 [main] DEBUG nextflow.executor.ExecutorFactory - >> processorType: 'slurm'
10月-12 16:27:18.483 [main] DEBUG nextflow.executor.ExecutorFactory - << taskConfig executor: slurm
10月-12 16:27:18.483 [main] DEBUG nextflow.executor.ExecutorFactory - >> processorType: 'slurm'
10月-12 16:27:18.496 [main] DEBUG nextflow.executor.ExecutorFactory - << taskConfig executor: slurm
10月-12 16:27:18.496 [main] DEBUG nextflow.executor.ExecutorFactory - >> processorType: 'slurm'
10月-12 16:27:18.509 [main] DEBUG nextflow.executor.ExecutorFactory - << taskConfig executor: local
10月-12 16:27:18.509 [main] DEBUG nextflow.executor.ExecutorFactory - >> processorType: 'local'
10月-12 16:27:18.514 [main] DEBUG nextflow.executor.Executor - [warm up] executor > local
10月-12 16:27:18.634 [main] DEBUG n.processor.LocalPollingMonitor - Creating local task monitor for executor 'local' > cpus=64; memory=125.2 GB; capacity=64; pollInterval=100ms; dumpInterval=5m
10月-12 16:27:18.659 [main] DEBUG nextflow.executor.ExecutorFactory - << taskConfig executor: local
10月-12 16:27:18.659 [main] DEBUG nextflow.executor.ExecutorFactory - >> processorType: 'local'
10月-12 16:27:18.670 [main] DEBUG nextflow.executor.ExecutorFactory - << taskConfig executor: local
10月-12 16:27:18.670 [main] DEBUG nextflow.executor.ExecutorFactory - >> processorType: 'local'
10月-12 16:27:18.680 [main] DEBUG nextflow.executor.ExecutorFactory - << taskConfig executor: local
10月-12 16:27:18.681 [main] DEBUG nextflow.executor.ExecutorFactory - >> processorType: 'local'
10月-12 16:27:18.691 [main] DEBUG nextflow.executor.ExecutorFactory - << taskConfig executor: local
10月-12 16:27:18.691 [main] DEBUG nextflow.executor.ExecutorFactory - >> processorType: 'local'
10月-12 16:27:18.698 [main] DEBUG nextflow.executor.ExecutorFactory - << taskConfig executor: local
10月-12 16:27:18.699 [main] DEBUG nextflow.executor.ExecutorFactory - >> processorType: 'local'
10月-12 16:27:18.706 [main] DEBUG nextflow.executor.ExecutorFactory - << taskConfig executor: local
10月-12 16:27:18.706 [main] DEBUG nextflow.executor.ExecutorFactory - >> processorType: 'local'
10月-12 16:27:18.710 [main] DEBUG nextflow.script.ScriptRunner - > Await termination 
10月-12 16:27:18.710 [main] DEBUG nextflow.Session - Session await
10月-12 16:27:18.724 [Actor Thread 4] DEBUG nextflow.conda.CondaCache - Conda found local env for environment=/mnt/ilustre/users/dna/miniconda3/envs/qiime2-2021.8; path=/mnt/ilustre/users/dna/miniconda3/envs/qiime2-2021.8
10月-12 16:27:18.908 [Actor Thread 2] INFO  nextflow.processor.TaskProcessor - [4d/5d0d71] Cached process > importfq
10月-12 16:27:19.067 [Actor Thread 6] INFO  nextflow.processor.TaskProcessor - [50/5256a6] Cached process > DeNoise
10月-12 16:27:19.089 [Actor Thread 1] INFO  nextflow.processor.TaskProcessor - [c4/378239] Cached process > Tree
10月-12 16:27:19.091 [Actor Thread 11] INFO  nextflow.processor.TaskProcessor - [7d/0d978c] Cached process > classify
10月-12 16:27:19.137 [Actor Thread 15] INFO  nextflow.processor.TaskProcessor - [f6/f7bfdb] Cached process > adonis
10月-12 16:27:19.180 [Task submitter] DEBUG nextflow.executor.LocalTaskHandler - Launch cmd line: /bin/bash -ue .command.run
10月-12 16:27:19.188 [Task submitter] INFO  nextflow.Session - [18/b4703d] Submitted process > Abundance
10月-12 16:27:19.203 [Task submitter] DEBUG nextflow.executor.LocalTaskHandler - Launch cmd line: /bin/bash -ue .command.run
10月-12 16:27:19.204 [Task submitter] INFO  nextflow.Session - [77/5723a5] Submitted process > Hierarchical
10月-12 16:27:19.219 [Task submitter] DEBUG nextflow.executor.LocalTaskHandler - Launch cmd line: /bin/bash -ue .command.run
10月-12 16:27:19.219 [Task submitter] INFO  nextflow.Session - [72/7b881a] Submitted process > PCOA
10月-12 16:27:19.228 [Task submitter] DEBUG nextflow.executor.LocalTaskHandler - Launch cmd line: /bin/bash -ue .command.run
10月-12 16:27:19.229 [Task submitter] INFO  nextflow.Session - [7f/5cca06] Submitted process > Dist
10月-12 16:27:19.237 [Task submitter] DEBUG nextflow.executor.LocalTaskHandler - Launch cmd line: /bin/bash -ue .command.run
10月-12 16:27:19.238 [Task submitter] INFO  nextflow.Session - [0d/1bfb83] Submitted process > Alpha
10月-12 16:27:19.246 [Task submitter] DEBUG nextflow.executor.LocalTaskHandler - Launch cmd line: /bin/bash -ue .command.run
10月-12 16:27:19.246 [Task submitter] INFO  nextflow.Session - [e3/133718] Submitted process > Rarecurve
10月-12 16:27:48.065 [Task monitor] DEBUG n.processor.TaskPollingMonitor - Task completed > TaskHandler[id: 5; name: PCOA; status: COMPLETED; exit: 0; error: -; workDir: /mnt/ilustre/users/dna/Pipeline/NextFlow/bio-nextflow/Ampliseq/work/72/7b881a13282bfe111887f5058f17d4]
10月-12 16:27:48.096 [Task monitor] DEBUG n.processor.TaskPollingMonitor - Task completed > TaskHandler[id: 8; name: Dist; status: COMPLETED; exit: 0; error: -; workDir: /mnt/ilustre/users/dna/Pipeline/NextFlow/bio-nextflow/Ampliseq/work/7f/5cca06c8bfb2c5340537361370a5c9]
10月-12 16:27:49.994 [Task monitor] DEBUG n.processor.TaskPollingMonitor - Task completed > TaskHandler[id: 9; name: Alpha; status: COMPLETED; exit: 0; error: -; workDir: /mnt/ilustre/users/dna/Pipeline/NextFlow/bio-nextflow/Ampliseq/work/0d/1bfb8358aa10576c9abc7d035ee6e9]
10月-12 16:27:50.873 [Task monitor] DEBUG n.processor.TaskPollingMonitor - Task completed > TaskHandler[id: 7; name: Hierarchical; status: COMPLETED; exit: 1; error: -; workDir: /mnt/ilustre/users/dna/Pipeline/NextFlow/bio-nextflow/Ampliseq/work/77/5723a5eca20412e8dc5eac9b34cc68]
10月-12 16:27:50.930 [Task monitor] ERROR nextflow.processor.TaskProcessor - Error executing process > 'Hierarchical'

Caused by:
  Process `Hierarchical` terminated with an error exit status (1)

Command executed:

  #!/usr/bin/env Rscript
  library(MicrobiotaProcess)
  library(phyloseq)
  library(tidyverse)
  library(RColorBrewer)
  library(ggtree)
  otu <- "table.qza"
  rep <- "rep-seqs.qza"
  tree <- "rooted-tree.qza"
  tax <- "taxonomy.qza"
  sample <- "meta.list"
  ps <- mp_import_qiime2(otuqza=otu, taxaqza=tax,refseqqza=rep,mapfilename=sample,treeqza=tree)
  ps %<>% mp_rrarefy()
  ps %<>% mp_decostand(.abundance=Abundance)
  ps %<>% mp_cal_abundance(add=on)
  ps %<>% mp_cal_clust(
       .abundance=hellinger, 
       distmethod = "bray",
       hclustmethod = "average", # (UPGAE)
       action = "add" # action is used to control which result will be returned
     )
  sample.clust <- ps %>% mp_extract_internal_attr(name='SampleClust')
  phyla.tb <- ps %>% mp_extract_abundance(taxa.class=Phylum, topn=30)
  phyla.tb %<>% tidyr::unnest(cols=RareAbundanceBySample) %>% dplyr::rename(Phyla="label")
  p <- ggtree(sample.clust) + 
     geom_tippoint(aes(color=time)) +
     geom_tiplab()
  p1 <- p + 
    geom_fruit(
       data=phyla.tb,
       geom=geom_col,
       mapping = aes(x = RelRareAbundanceBySample, 
                     y = Sample, 
                     fill = Phyla
               ),
       orientation = "y",
       offset = 0.4,
       pwidth = 3, 
       axis.params = list(axis = "x", 
                          title = "The relative abundance of phyla (%)",
                          title.size = 4,
                          text.size = 2, 
                          vjust = 1),
       grid.params = list()
    )
  ggsave(file="Hierarchical.pdf",p1)

Command exit status:
  1

Command output:
  WARNING: ignoring environment value of R_HOME

Command error:
  
  载入程辑包：‘MicrobiotaProcess’
  
  The following object is masked from ‘package:stats’:
  
      filter
  
  
  载入程辑包：‘phyloseq’
  
  The following object is masked from ‘package:MicrobiotaProcess’:
  
      refseq
  
  ─ Attaching packages ──────────────────── tidyverse 1.3.1 ─
  ✔ ggplot2 3.3.5     ✔ purrr   0.3.4
  ✔ tibble  3.1.5     ✔ dplyr   1.0.7
  ✔ tidyr   1.1.4     ✔ stringr 1.4.0
  ✔ readr   2.0.2     ✔ forcats 0.5.1
  ─ Conflicts ───────────────────── tidyverse_conflicts() ─
  ✖ dplyr::filter() masks MicrobiotaProcess::filter(), stats::filter()
  ✖ dplyr::lag()    masks stats::lag()
  ggtree v3.0.4  For help: https://yulab-smu.top/treedata-book/
  
  If you use ggtree in published research, please cite the most appropriate paper(s):
  
  1. Guangchuang Yu. Using ggtree to visualize data on tree-like structures. Current Protocols in Bioinformatics, 2020, 69:e96. doi:10.1002/cpbi.96
  2. Guangchuang Yu, Tommy Tsan-Yuk Lam, Huachen Zhu, Yi Guan. Two methods for mapping and visualizing associated data on phylogeny using ggtree. Molecular Biology and Evolution 2018, 35(12):3041-3043. doi:10.1093/molbev/msy194
  3. Guangchuang Yu, David Smith, Huachen Zhu, Yi Guan, Tommy Tsan-Yuk Lam. ggtree: an R package for visualization and annotation of phylogenetic trees with their covariates and other associated data. Methods in Ecology and Evolution 2017, 8(1):28-36. doi:10.1111/2041-210X.12628
  
  
  
  载入程辑包：‘ggtree’
  
  The following object is masked from ‘package:tidyr’:
  
      expand
  
  Warning message:
  The treeqza is a tree file, it is parsing by read.tree function.
  * It is better to parse it with the function of treeio
  * then the treedata or phylo result all can be supported. 
  The result was added to the internal attributes of the object
  It can be extracted via object %>% mp_extract_internal_attr(name='SampleClust') !
  The object contained internal attribute: SampleClust
  Error in geom_fruit(data = phyla.tb, geom = geom_col, mapping = aes(x = RelRareAbundanceBySample,  : 
    没有"geom_fruit"这个函数
  停止执行

Work dir:
  /mnt/ilustre/users/dna/Pipeline/NextFlow/bio-nextflow/Ampliseq/work/77/5723a5eca20412e8dc5eac9b34cc68

Tip: you can try to figure out what's wrong by changing to the process work dir and showing the script file named `.command.sh`
10月-12 16:27:50.939 [Task monitor] DEBUG nextflow.Session - Session aborted -- Cause: Process `Hierarchical` terminated with an error exit status (1)
10月-12 16:27:51.171 [main] DEBUG nextflow.Session - Session await > all process finished
10月-12 16:27:51.185 [main] DEBUG nextflow.Session - Session await > all barriers passed
10月-12 16:27:51.849 [main] WARN  n.processor.TaskPollingMonitor - Killing pending tasks (2)
10月-12 16:27:52.011 [main] DEBUG nextflow.trace.WorkflowStatsObserver - Workflow completed > WorkflowStats[succeededCount=3; failedCount=1; ignoredCount=0; cachedCount=5; pendingCount=0; submittedCount=0; runningCount=0; retriesCount=0; abortedCount=2; succeedDuration=1m 28s; failedDuration=31.6s; cachedDuration=3h 45m 19s;loadCpus=0; loadMemory=0; peakRunning=6; peakCpus=6; peakMemory=0; ]
10月-12 16:27:52.056 [main] DEBUG nextflow.CacheDB - Closing CacheDB done
10月-12 16:27:52.093 [main] DEBUG nextflow.script.ScriptRunner - > Execution complete -- Goodbye
